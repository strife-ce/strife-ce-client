<div *ngIf="state == EChatAccountState.PREPARING_MATCH"
  style="position:absolute; left:0; right:0; top:0px; bottom:0; background:rgba(255,255,255,0.7); z-index:99999; display:flex; align-items: center; justify-content: center; ">
  <h1>Game Found! Joining in a moment...</h1>
</div>

<div class="row h-100">
  <div class="col-md-6 d-flex flex-column align-items-stretch" style="padding:0px 10px 0px 0px; background-color: #ddd">
    <div class="card-header" style="background-color: #f3f3f3">

      <ul class="nav nav-tabs card-header-tabs">
        <li class="nav-item" style="display:block; width: 146px;">
          <h5 class="title" style="padding:0px;margin: 5px 0px 0px 5px; border: none">Chat</h5>
        </li>
        <li class="nav-item" *ngFor="let tab of getAttributes(chatTabs)">
          <a class="nav-link {{((tab.active) ? 'active' :'')}} {{((tab.disabled) ? ' disabled' :'')}}"
            (click)="switchTab(chatTabs, tab)">{{tab.label}} ({{getChatAccounts().length}})</a>
        </li>
      </ul>
    </div>
    <div class="flex-fill d-flex" style="background-color: #fff">
      <div class="row flex-fill">
        <div class="col-md-3 d-flex flex-column" style="padding-right:0px; border-right: 1px solid #ddd">
          <div class="flex-fill" style="overflow-y: auto; position:relative">
            <div style="height:10px"></div>
            <div *ngFor="let chatAccount of getChatAccounts()">
              <span style="padding: 5px 6px">
                <span style="width: 16px; height:16px; margin-right:4px; display: inline-block">
                  <a href="https://www.patreon.com/strife_ce" [ngbTooltip]="chatAccount.iconTooltip" placement="right"
                    target="_blank" *ngIf="chatAccount.icon">
                    <img src="assets/images/icons/{{chatAccount.icon}}.png" style="width:16px; margin-top:-5px;" />
                  </a>
                </span>
                <span *ngIf="chatAccount.hasFlag(EAccountFlags.MODERATOR)" style="font-weight:bold; color: #E6461A"
                  ngbTooltip="Moderator" container="body">{{chatAccount.name}}</span>
                <span *ngIf="!chatAccount.hasFlag(EAccountFlags.MODERATOR)">{{chatAccount.name}}</span>
                <span *ngIf="chatAccount.stateIcon" [class]="'fa fa-' + chatAccount.stateIcon"
                  style="position:absolute; right: 10px; margin-top:2px; color: #bbb"></span>
              </span>
            </div>
          </div>
        </div>
        <div class="col-md-9 d-flex flex-column" style="padding-left:0px;">

          <div id="chatbox" class="flex-fill d-flex flex-column">
            <div
              style="box-sizing: border-box; background-color:#F7F7F7; border-bottom: 1px solid #eee; position:relative; min-height:83px; max-height:83px; overflow:hidden; padding-top: 6px; padding-left: 6px"
              *ngIf="this.chatAccount && !this.chatAccount.icon">
              <!-- strife -->
              <ins class="adsbygoogle"
                style="display:inline-block;width:468px;height:60px"
                data-ad-client="ca-pub-8248851277942593"
                data-ad-slot="5670932491"></ins>
              <!--<ng-adsense [display]="'inline-block'" [width]="468" [height]="60" [adClient]="'ca-pub-8248851277942593'"
                [adSlot]="5670932491" [adFormat]="'horizontal'">
              </ng-adsense>-->
              <br />
              <span style="font-size:10px; position:absolute; bottom:0px; right: 5px; background-color: #fff">
                You want no more ads? <a target="_blank" href="https://www.patreon.com/bePatron?u=19872450"
                  data-patreon-widget-type="become-patron-button">Support Strife CE at Patreon</a>
              </span>
            </div>
            <div
              style="box-sizing: border-box; background-color:#F7F7F7; border-bottom: 1px solid #eee; border-top: 1px solid #eee; position:relative; min-height:20px; padding: 6px 10px; font-size: 12px; color:#aaa;">
              <div style="text-align:right">

                <span style="position:absolute; left: 10px; font-weight:bold">Chat Options</span>

                <span style="padding-right:20px">
                  <a *ngIf="translationMode != ETranslationMode.TO_EN && translationMode != ETranslationMode.TO_RU"
                    (click)="switchTranslationMode()"><span class="fa fa-language"></span>&nbsp; auto translate:
                    disabled</a>
                  <a *ngIf="translationMode == ETranslationMode.TO_EN" (click)="switchTranslationMode()"><span
                      class="fa fa-language"></span>&nbsp; auto translate: any ->
                    English</a>
                  <a *ngIf="translationMode == ETranslationMode.TO_RU" (click)="switchTranslationMode()"><span
                      class="fa fa-language"></span>&nbsp; auto translate: any ->
                    Russian</a>
                </span>
                <a *ngIf="!isChatAudioMuted" (click)="toggleMute()"><span class="fa fa-volume-up"></span>&nbsp; alerts:
                  on</a>
                <a *ngIf="isChatAudioMuted" (click)="toggleMute()" style="font-size: 12px; color:#aaa"><span
                    class="fa fa-volume-mute"></span>&nbsp; alerts: off</a>
              </div>
            </div>
            <div class="flex-fill d-flex flex-column" style="padding:10px">
              <dl class="flex-fill" id="messageList" style="overflow: auto; margin-right: -8px"
                [style.max-height.px]="(this.chatAccount && !this.chatAccount.icon) ? 508 : 587" #chatScrollContainer>
                <div class="msg" *ngFor="let msg of messages" [style.background-color]="msg.highlight ? '#dbe4f5': ''"
                  ngbTooltip="By {{msg.account.name}} at {{msg.arrivedAt}}" placement="top">
                  <span style="width: 16px; height:16px; margin-right:4px; display: inline-block"
                    *ngIf="msg.account.icon">
                    <a href="https://www.patreon.com/strife_ce" [ngbTooltip]="msg.account.iconTooltip" placement="top"
                      target="_blank">
                      <img src="assets/images/icons/{{msg.account.icon}}.png" style="width:16px; margin-top:-5px;" />
                    </a>
                  </span>
                  <span style="font-weight:600">{{msg.account.name}}:&nbsp;</span>
                  <span *ngIf="msg.isTranslating" style="opacity:0.5"><span
                      class="fa fa-spinner fa-pulse"></span>&nbsp;</span>
                  <span *ngIf="msg.translatedMessage" style="opacity:0.5"><span
                      class="fa fa-language"></span>&nbsp;</span>
                  <span>{{msg.translatedMessage ? msg.translatedMessage : msg.message}}</span>
                </div>
              </dl>
              <form id="sendMessage" (ngSubmit)="sendMessage(); ">
                <div class='input-group'>
                  <input [disabled]="chatDisabled" #sendMsgInput type='text' name='message' class="form-control"
                    placeholder="Type your message..." autofocus autocomplete="off">

                  <div class='input-group-append'>
                    <button [disabled]="chatDisabled" class='btn btn-primary'>Send</button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-md-6 d-flex flex-column" style="padding-right: 0px; padding-left: 0px">
    <div class="row flex-fill d-flex">
      <div class="col-md-12 flex-fill d-flex flex-column">
        <div class="card flex-fill d-flex" style="border: none;">
          <div class="card-header" style="border-top: 1px solid rgba(0, 0, 0, 0.125); padding: 10px 12px">
            <ng-template ng-template ngFor let-tab [ngForOf]="getAttributes(mainMenuTabs)">
              <a class="mainNav {{((tab.active) ? 'active' :'')}}  {{((tab.disabled) ? 'disabled' :'')}}"
                *ngIf="(tab.hide !== true)" (click)="switchTab(mainMenuTabs, tab)">
                <span [class]="tab.icon"></span> {{tab.name}}
              </a>
            </ng-template>
            <a class="mainNav deactivated" [ngbTooltip]="'Coming soon..'">
              <span class="fa fa-pencil-ruler"></span> Crafting
            </a>
            <a class="mainNav deactivated" [ngbTooltip]="'Coming soon..'">
              <span class="fa fa-user-astronaut"></span> Heroes
            </a>
            <a class="mainNav deactivated" [ngbTooltip]="'Coming soon..'">
              <span class="fa fa-paw"></span> Pets
            </a>

            <a class="mainNav deactivated" style="position:absolute; right:10px; top:2px" *ngIf="chatAccount"
              [ngbTooltip]="'Coming soon..'">
              <span class="fa fa-user"></span> {{chatAccount.name}}
            </a>


          </div>
          <div *ngIf="mainMenuTabs.PLAY.active">
            <div class="card-header" style="background-color: #f3f3f3">
              <div></div>
              <ul class="nav nav-tabs card-header-tabs">
                <li class="nav-item" *ngFor="let tab of getAttributes(playTabs)">
                  <a class="nav-link {{((tab.active) ? 'active' :'')}} {{((tab.disabled) ? 'disabled' :'')}}"
                    (click)="switchTab(playTabs, tab)">{{tab.name}}</a>
                </li>
              </ul>
            </div>
            <div class="card-body">

              <div style="position:absolute; right: 15px; margin-top: -72px">
                <circle-progress [percent]="queueStates[EGameMode.MODE_1ON1]/2*100" [radius]="20" [outerStrokeWidth]="3"
                  [innerStrokeWidth]="3" [space]="-3" [outerStrokeColor]="'#a4a7ae'" [innerStrokeColor]="'#e7e8ea'"
                  [animation]="true" [titleFontSize]="16" [subtitleColor]="'#aaaaaa'" [animationDuration]="300"
                  [title]="queueStates[EGameMode.MODE_1ON1]" subtitle="1vs1&nbsp;&nbsp;" units=""
                  [startFromZero]="false">
                </circle-progress>

                <circle-progress [percent]="queueStates[EGameMode.MODE_2ON2]/4*100" [radius]="20" [outerStrokeWidth]="3"
                  [innerStrokeWidth]="3" [space]="-3" [outerStrokeColor]="'#a4a7ae'" [innerStrokeColor]="'#e7e8ea'"
                  [animation]="true" [titleFontSize]="16" [subtitleColor]="'#aaaaaa'" [animationDuration]="300"
                  [title]="queueStates[EGameMode.MODE_2ON2]" subtitle="2vs2&nbsp;&nbsp;" units=""
                  [startFromZero]="false">
                </circle-progress>

                <circle-progress [percent]="queueStates[EGameMode.MODE_3ON3]/6*100" [radius]="20" [outerStrokeWidth]="3"
                  [innerStrokeWidth]="3" [space]="-3" [outerStrokeColor]="'#a4a7ae'" [innerStrokeColor]="'#e7e8ea'"
                  [animation]="true" [titleFontSize]="16" [subtitleColor]="'#aaaaaa'" [animationDuration]="300"
                  [title]="queueStates[EGameMode.MODE_3ON3]" subtitle="3vs3&nbsp;&nbsp;" units=""
                  [startFromZero]="false">
                </circle-progress>

                <circle-progress [percent]="queueStates[EGameMode.MODE_5ON5]/10*100" [radius]="20"
                  [outerStrokeWidth]="3" [innerStrokeWidth]="3" [space]="-3" [outerStrokeColor]="'#a4a7ae'"
                  [innerStrokeColor]="'#e7e8ea'" [animation]="true" [titleFontSize]="16" [subtitleColor]="'#aaaaaa'"
                  [animationDuration]="300" [title]="queueStates[EGameMode.MODE_5ON5]" subtitle="5vs5&nbsp;&nbsp;"
                  units="" [startFromZero]="false">
                </circle-progress>
              </div>
              <div *ngIf="playTabs.BOT_GAME.active">
                <div class="row" style="padding-bottom:10px">
                  <div class="col-md-12">
                    Select a Hero:<br />
                    <ng-template ngFor let-heroValue [ngForOf]="getEnumValues(EHeroEnum)">
                      <a class="heroSelect" *ngIf="heroValue > EHeroEnum.NO_HERO" (click)="selectHero(heroValue)">
                        <img [src]="getHeroIcon(heroValue)" [style.opacity]="selectedHero == heroValue ? '1.0' : 0.5"
                          [ngbTooltip]="HeroEnumText.get(heroValue)">
                      </a>
                    </ng-template>
                  </div>
                </div>
                <div class="row" style="padding-bottom:10px">
                  <div class="col-md-12">
                    Select a Pet: <br />
                    <ng-template ngFor let-petValue [ngForOf]="getEnumValues(EPetEnum)">
                      <a class="heroSelect" *ngIf="petValue > EPetEnum.NO_PET" (click)="selectPet(petValue)">
                        <img [src]="getPetIcon(petValue)" [style.opacity]="selectedPet == petValue ? '1.0' : 0.5"
                          [ngbTooltip]="PetEnumText.get(petValue)">
                      </a>
                    </ng-template>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-12" style="margin-top:14px;">
                    Select a difficulty level:
                    <select class="custom-select" [(ngModel)]="selectedBotDifficulty">
                      <option value="easy">
                        Easy
                      </option>
                      <option value="normal">
                        Normal
                      </option>
                      <option value="hard">
                        Hard
                      </option>
                    </select>
                  </div>
                  <div class="col-md-12" style="position:absolute; bottom: 10px;">
                    &nbsp;
                    <button class="btn btn-primary btn-block" (click)="joinBotGame()">Play versus Bots</button>
                  </div>
                </div>
              </div>
              <div *ngIf="playTabs.STORY.active">
                <button class="btn btn-primary btn-block" style="margin-bottom:20px"
                  (click)="joinStoryMap('bastact1')">Story of Bastion</button>
                <button class="btn btn-primary btn-block" (click)="joinStoryMap('tutorial')">Story of Caprice
                  (Tutorial
                  Part 1)
                </button>
                <button class="btn btn-primary btn-block" (click)="joinStoryMap('tutorial_2')">Story of Caprice
                  (Tutorial
                  Part 2)
                </button>
                <button class="btn btn-primary btn-block" (click)="joinStoryMap('tutorial_3')">Story of Caprice
                  (Tutorial
                  Part 3)
                </button>
              </div>
              <div *ngIf="playTabs.EARLY_ACCESS.active">
                In Early Access, <a href="https://www.patreon.com/strife_ce" target="_blank">
                  <img [src]="'assets/images/icons/patreon1.png'" style="width:16px; margin-top:-5px;" />
                  Patreon Supporters
                </a> of Strife CE can play the <b>latest balance changes and new heroes</b> even before it gets released
                to the rest of the
                world.<br /><br /> Currently the first balance patch is in development and is made available here as
                soon
                as possible.
              </div>
              <div *ngIf="playTabs.MATCHMAKING.active">
                <div *ngIf="state == EChatAccountState.IDLE || state == EChatAccountState.PARTYING">
                  <div class="row" style="padding-bottom:10px">
                    <div class="col-md-12">
                      Select a Hero:<br />
                      <ng-template ngFor let-heroValue [ngForOf]="getEnumValues(EHeroEnum)">
                        <span *ngIf="heroValue > EHeroEnum.NO_HERO">
                          <span class="heroSelectInactive" style="position:relative"
                            *ngIf="getPlayerOfHero(heroValue) != undefined && selectedHero != heroValue">
                            <span class="fa fa-times"
                              style="position:absolute; top:6px; left:0px; right:0px; bottom:0px; font-size: 30px; opacity: 0.7; text-align: center;"></span>
                            <img [src]="getHeroIcon(heroValue)" [style.opacity]="0.3"
                              [ngbTooltip]="'Taken by ' + getPlayerOfHero(heroValue).chatAccount.name" container="body">
                          </span>
                          <a class="heroSelect" (click)="selectHero(heroValue)"
                            *ngIf="getPlayerOfHero(heroValue) == undefined || selectedHero == heroValue">
                            <img [src]="getHeroIcon(heroValue)"
                              [style.opacity]="selectedHero == heroValue ? '1.0' : 0.5"
                              [ngbTooltip]="HeroEnumText.get(heroValue)">
                          </a>
                        </span>
                      </ng-template>
                    </div>
                  </div>
                  <div class="row" style="padding-bottom:10px">
                    <div class="col-md-12">
                      Select a Pet: <br />
                      <ng-template ngFor let-petValue [ngForOf]="getEnumValues(EPetEnum)">
                        <a class="heroSelect" *ngIf="petValue > EPetEnum.NO_PET" (click)="selectPet(petValue)">
                          <img [src]="getPetIcon(petValue)" [style.opacity]="selectedPet == petValue ? '1.0' : 0.5"
                            [ngbTooltip]="PetEnumText.get(petValue)">
                        </a>
                      </ng-template>
                    </div>
                  </div>
                  <div class="row" style="padding-bottom:10px">
                    <div class="col-md-12">
                      Players of your party:<br />
                      <div style="width:112px;" class="float-left" *ngIf="!party && chatAccount">
                        <div style="width:100%;">
                          <b>{{chatAccount.name}}</b>
                        </div>
                        <div>
                          <img style="width:40px" [src]="getHeroIcon(selectedHero)"
                            [ngbTooltip]="HeroEnumText.get(selectedHero)">
                          <img style="width:40px; margin-left:0px" [src]="getPetIcon(selectedPet)"
                            [ngbTooltip]="PetEnumText.get(selectedPet)">
                        </div>
                      </div>
                      <div *ngIf="party">
                        <div style="width:112px; position:relative" class="float-left"
                          *ngFor="let member of party.members">
                          <a style="position:absolute; left: 0px; right: 0px; bottom:0px; top:0px; z-index:9999;"
                            ngbTooltip="Remove {{member.chatAccount.name}} from party" placement="top"
                            *ngIf="chatAccount.id != member.chatAccount.id && chatAccount.id == party.chief.id"
                            (click)="removePlayerFromParty(member)"></a>
                          <div [style.opacity]="(member.state == EPartyMemberState.INVITE_PENDING) ? 0.5 : 1.0">
                            <div style="width:100%;">
                              <b style="font-size:12px;">

                                <span class="fa fa-ellipsis-h"
                                  *ngIf="member.state == EPartyMemberState.INVITE_PENDING"></span>
                                <span class="fa fa-user-cog" *ngIf="member.state == EPartyMemberState.NORMAL"></span>
                                <span class="fa fa-user-check" *ngIf="member.state == EPartyMemberState.READY"></span>
                                {{member.chatAccount.name}}</b>
                            </div>
                            <div>
                              <img style="width:40px" [src]="getHeroIcon(member.hero)"
                                [ngbTooltip]="HeroEnumText.get(member.hero)" placement="bottom">
                              <img style="width:40px; margin-left:0px" [src]="getPetIcon(member.pet)"
                                [ngbTooltip]="PetEnumText.get(member.pet)" placement="bottom">
                            </div>
                          </div>
                        </div>
                      </div>

                      <div style="width:112px;" class="float-left"
                        *ngIf="(!party || party.chief.id == chatAccount.id) && getMaxInviteCount() > 0">
                        <br />
                        <a style="font-size: 40px" class="fa fa-plus-square" (click)="openModal(invitePlayers)"></a>
                      </div>

                    </div>
                  </div>
                  <br />
                  <div class="row" style="position:absolute; bottom: 20px; left: 20px; right: 20px;">
                    <ng-template [ngIf]="!party || party.members.length == 1">
                      <div class="col-md-9">
                        Select one or multiple gamemodes: <br />
                        <ng-toggle onColor="success" offColor="light" size="sm"
                          [(ngModel)]="selectedGameModes[EGameMode.MODE_1ON1]">
                          <ng-template ngToggleLabel forLabel="on"><span
                              class="fa fa-check-circle"></span>&nbsp;&nbsp;1vs1
                          </ng-template>
                          <ng-template ngToggleLabel forLabel="off"><span
                              class="fa fa-times-circle"></span>&nbsp;&nbsp;1vs1
                          </ng-template>
                        </ng-toggle>
                        &nbsp;
                        <ng-toggle onColor="success" offColor="light" size="sm"
                          [(ngModel)]="selectedGameModes[EGameMode.MODE_2ON2]">
                          <ng-template ngToggleLabel forLabel="on"><span
                              class="fa fa-check-circle"></span>&nbsp;&nbsp;2vs2
                          </ng-template>
                          <ng-template ngToggleLabel forLabel="off"><span
                              class="fa fa-times-circle"></span>&nbsp;&nbsp;2vs2
                          </ng-template>
                        </ng-toggle>
                        &nbsp;
                        <ng-toggle onColor="success" offColor="light" size="sm"
                          [(ngModel)]="selectedGameModes[EGameMode.MODE_3ON3]">
                          <ng-template ngToggleLabel forLabel="on"><span
                              class="fa fa-check-circle"></span>&nbsp;&nbsp;3vs3
                          </ng-template>
                          <ng-template ngToggleLabel forLabel="off"><span
                              class="fa fa-times-circle"></span>&nbsp;&nbsp;3vs3
                          </ng-template>
                        </ng-toggle>
                        &nbsp;
                        <ng-toggle onColor="success" offColor="light" size="sm"
                          [(ngModel)]="selectedGameModes[EGameMode.MODE_5ON5]">
                          <ng-template ngToggleLabel forLabel="on"><span
                              class="fa fa-check-circle"></span>&nbsp;&nbsp;5vs5
                          </ng-template>
                          <ng-template ngToggleLabel forLabel="off"><span
                              class="fa fa-times-circle"></span>&nbsp;&nbsp;5vs5
                          </ng-template>
                        </ng-toggle>
                      </div>
                      <div class="col-md-3" style="padding-top:18px; padding-left:2px;">
                        <button class="btn btn-primary btn-block" (click)="startGameSearch()">Start</button>
                      </div>
                    </ng-template>
                    <ng-template #partyMode [ngIf]="party && party.members.length > 1">
                      <div class="col-md-6">
                        {{isPartyChief() ? 'Select one or multiple gamemodes:' : 'Selected gamemodes by the party chief:'}}
                        <br />
                        <ng-toggle onColor="success" offColor="light" size="sm"
                          [value]="selectedGameModes[EGameMode.MODE_2ON2]"
                          [disabled]='!isGameModeEnabledInParty(EGameMode.MODE_2ON2)'
                          (valueChange)="partyGameModeChanged(EGameMode.MODE_2ON2, $event)">
                          <ng-template ngToggleLabel forLabel="on"><span
                              class="fa fa-check-circle"></span>&nbsp;&nbsp;2vs2
                          </ng-template>
                          <ng-template ngToggleLabel forLabel="off"><span
                              class="fa fa-times-circle"></span>&nbsp;&nbsp;2vs2
                          </ng-template>
                        </ng-toggle>
                        &nbsp;
                        <ng-toggle onColor="success" offColor="light" size="sm"
                          [value]="selectedGameModes[EGameMode.MODE_3ON3]"
                          [disabled]='!isGameModeEnabledInParty(EGameMode.MODE_3ON3)'
                          (valueChange)="partyGameModeChanged(EGameMode.MODE_3ON3, $event)">
                          <ng-template ngToggleLabel forLabel="on"><span
                              class="fa fa-check-circle"></span>&nbsp;&nbsp;3vs3
                          </ng-template>
                          <ng-template ngToggleLabel forLabel="off"><span
                              class="fa fa-times-circle"></span>&nbsp;&nbsp;3vs3
                          </ng-template>
                        </ng-toggle>
                        &nbsp;
                        <ng-toggle onColor="success" offColor="light" size="sm"
                          [value]="selectedGameModes[EGameMode.MODE_5ON5]"
                          [disabled]='!isGameModeEnabledInParty(EGameMode.MODE_5ON5)'
                          (valueChange)="partyGameModeChanged(EGameMode.MODE_5ON5, $event)">
                          <ng-template ngToggleLabel forLabel="on"><span
                              class="fa fa-check-circle"></span>&nbsp;&nbsp;5vs5
                          </ng-template>
                          <ng-template ngToggleLabel forLabel="off"><span
                              class="fa fa-times-circle"></span>&nbsp;&nbsp;5vs5
                          </ng-template>
                        </ng-toggle>
                      </div>
                      <div class="col-md-3" style="padding-top:18px; padding-right:2px;"
                        *ngIf="partyMember.state !== EPartyMemberState.READY">
                        <button class="btn btn-danger btn-block" (click)="leaveParty()">Leave party</button>
                      </div>
                      <div class="col-md-3" style="padding-top:18px; padding-left:2px;"
                        *ngIf="partyMember.state !== EPartyMemberState.READY">
                        <button class="btn btn-primary btn-block" (click)="startGameSearch()">Ready</button>
                      </div>
                      <div class="col-md-3" style="padding-top:18px; padding-right:2px;"
                        *ngIf="partyMember.state === EPartyMemberState.READY">
                        <div style="font-size:12px; line-height:14px; padding-top:6px">Waiting for other players to be
                          ready...</div>
                      </div>
                      <div class="col-md-3" style="padding-top:18px; padding-left:2px;"
                        *ngIf="partyMember.state === EPartyMemberState.READY">
                        <button class="btn btn-primary btn-block" (click)="notReady()">Not ready</button>
                      </div>
                    </ng-template>
                  </div>

                </div>
                <div *ngIf="state == EChatAccountState.QUEUE || state == EChatAccountState.PREPARING_MATCH">
                  <div class="row">
                    <div class="col-6">
                      Gamemodes:
                    </div>
                    <div class="col-6">
                      <b>
                        {{selectedGameModes[EGameMode.MODE_1ON1]? '1vs1':''}}
                        {{selectedGameModes[EGameMode.MODE_2ON2]? '2vs2':''}}
                        {{selectedGameModes[EGameMode.MODE_3ON3]? '3vs3':''}}
                        {{selectedGameModes[EGameMode.MODE_5ON5]? '5vs5':''}}
                      </b>
                    </div>
                    <div class="col-6">
                      Hero:
                    </div>
                    <div class="col-6">
                      <b>{{HeroEnumText.get(selectedHero)}}</b>
                    </div>
                    <div class="col-6">
                      Pet:
                    </div>
                    <div class="col-6">
                      <b>{{PetEnumText.get(selectedPet)}}</b>
                    </div>
                  </div>
                  <br /><br />
                  <div style="text-align:left">Searching for players, please wait... {{searchingTime}} seconds</div>
                  <br />
                  <button class="btn btn-danger btn-block" (click)="cancelGameSearch()">Abort searching</button>
                </div>

                <div *ngIf="state == EChatAccountState.INGAME">
                  <div class="row">
                    <div class="col-6">
                      Gamemodes:
                    </div>
                    <div class="col-6">
                      <b>
                        {{selectedGameModes[EGameMode.MODE_1ON1]? '1vs1':''}}
                        {{selectedGameModes[EGameMode.MODE_2ON2]? '2vs2':''}}
                        {{selectedGameModes[EGameMode.MODE_3ON3]? '3vs3':''}}
                        {{selectedGameModes[EGameMode.MODE_5ON5]? '5vs5':''}}
                      </b>
                    </div>
                    <div class="col-6">
                      Hero:
                    </div>
                    <div class="col-6">
                      <b>{{HeroEnumText.get(selectedHero)}}</b>
                    </div>
                    <div class="col-6">
                      Pet:
                    </div>
                    <div class="col-6">
                      <b>{{PetEnumText.get(selectedPet)}}</b>
                    </div>
                  </div>
                  <br /><br />
                  <div style="text-align:left">You left a running game. Please reconnect!</div>
                  <br />
                  <button class="btn btn-primary" style="width:252px; margin-right:10px" (click)="joinMatch()">Rejoin
                    the
                    game</button>
                  <button class="btn btn-danger" (click)="cancelMatch()">Abort game</button>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="mainMenuTabs.MODERATION.active">
            <app-dashboard-moderation *ngIf="user" [user]="user"></app-dashboard-moderation>
          </div>
          <!--<div *ngIf="mainMenuTabs.CRAFTING.active">
            <app-dashboard-crafting *ngIf="user" [user]="user"></app-dashboard-crafting>
          </div>-->
        </div>
      </div>
    </div>
    <div class="row" style="margin-bottom:0px; border-top: 1px solid #ddd">
      <div class="col-md-6" style="padding-right: 0px;">
        <h5 class="title">News</h5>
        <div style="padding:10px; height: 170px; font-size: 12px; overflow: auto">
          <div class="news">

            <ngb-accordion #acc="ngbAccordion" activeIds="ngb-panel-0">
              <ngb-panel title="v0.4.0 Balance/Client update [08/24]">
                <ng-template ngbPanelContent>
                  <ul>
                    <b><u>Balance</u></b>
                    <li>Blazer R nerf: reduced bonus damage from 100% to 10%</li>
                    <li>Vex W buff: priority of projectile targets from closest enemy to:
                      heroes > buildings > units</li>
                    <b><u><br />Client</u></b>
                    <li><b>Balance Patch downloader</b></li>
                    <li>Random Hero button (dev by The_Chiprel)</li>
                    <li><b>Reenabled Blazer</b></li>
                    <li>Fixed: Patreon status bar</li>
                    <li>Fixed: Open shop bug for new players</li>
                    <li>Fixed: Saving last selected/hero/gamemode pet</li>
                  </ul>
                </ng-template>
              </ngb-panel>
              <ngb-panel title="v0.3.2 Client update [06/16]">
                <ng-template ngbPanelContent>
                  <ul>
                    <li>Added penalty management: Ban for matches, ban for chat</li>
                    <li>Added moderators: Pad, Quarterstaff, Chotke</li>
                    <li>Moderators are colorized in chat</li>
                    <li><b>Report misbehaving players in discord (channel report-a-player)</b></li>
                  </ul>
                </ng-template>
              </ngb-panel>
              <ngb-panel title="v0.3.1 Client update [06/09]">
                <ng-template ngbPanelContent>
                  <ul>
                    <li><b>Automatic ru/en chat translation</b> in the client (props to Jertle for the idea!)</li>
                    <li><b>Reenabled ingame pings and chatwheel </b></li>
                    <li>Multiple arranged party related bugs fixed</li>
                    <li>Minor design fixes</li>
                  </ul>
                </ng-template>
              </ngb-panel>
              <ngb-panel title="v0.3.0 Client update [06/08]">
                <ng-template ngbPanelContent>
                  <ul>
                    <li><b>Arranged parties added</b></li>
                    <li>Reordering of client elements for better overview</li>
                    <li>Fix of chat scroll bug</li>
                    <li>Fix of cutted tooltips</li>
                    <li>Fix of search time value after multiple searches</li>
                    <li>Multiple server crash fixes</li>
                  </ul>
                </ng-template>
              </ngb-panel>
              <ngb-panel title="v0.2.0 Client update [05/21]">
                <ng-template ngbPanelContent>
                  <ul>
                    <li>Client Restructurizing!</li>
                    <li>Story, tutorial and bot-games added</li>
                    <li>Preparations for custom games and Parties</li>
                    <li>Ads for non-supporters (Sorry folks, its needed)</li>
                    <li>Restricted @all tags to once / 3 minutes</li>
                    <li>Added hero and pet icons (Thanks to chotke!)</li>
                  </ul>
                </ng-template>
              </ngb-panel>
              <ngb-panel title="v0.1.2 Client update">
                <ng-template ngbPanelContent>
                  <ul>
                    <li>Added a set of <b>94 preselected crafted</b> items to the shop (thanks to <b>treehead</b> and
                      <b>Neo1171</b> for preparing this!). If you want to request the addition of an crafted item,
                      talk
                      to
                      Neo1171 on Discord!</li>
                    <li>Added Paypal-Button for one-time donators</li>
                    <li>Fixed "one player multiple times in game"-bug</li>
                    <li>Fixed Testbutton bug</li>
                  </ul>
                </ng-template>
              </ngb-panel>
              <ngb-panel>
                <ng-template ngbPanelTitle>v0.1.1 Client update</ng-template>
                <ng-template ngbPanelContent>
                  <ul>
                    <li><b>Ingame Chat</b> is now working</li>
                    <li>Ingame Chat to all via prefixed exclamation mark (example: !Hello everyone)</li>
                    <li>Increased performance of Gameservers (running now in a <b>datacenter</b>)</li>
                    <li>Added operation cost coverage bar</li>
                    <li>Fixed Shop Bug for fresh installations</li>
                    <li>Fixed overflowing Chat User-List</li>
                  </ul>
                </ng-template>
              </ngb-panel>
              <ngb-panel>
                <ng-template ngbPanelTitle>v0.1.0 Client update</ng-template>
                <ng-template ngbPanelContent>
                  <ul>
                    <li>Matches don't end anymore after a player left</li>
                    <li>Reconnecting to a match is now possible</li>
                    <li>Audio alerts on receiving a @-tagged message</li>
                    <li>Remembering latest hero and pet selection</li>
                  </ul>
                </ng-template>
              </ngb-panel>
              <ngb-panel>
                <ng-template ngbPanelTitle>v0.0.4 Client update</ng-template>
                <ng-template ngbPanelContent>
                  <ul>
                    <li>Added player state indicators</li>
                    <li>Fixed a bug which lead to one player being multiple times in a game</li>
                    <li>Added the GRAND Patreon Supporter icon for supporters of 10+$ (Thank you Jertle)</li>
                    <li>Chat highlighting if you mention someone via @name</li>
                  </ul>
                </ng-template>
              </ngb-panel>
              <ngb-panel>
                <ng-template ngbPanelTitle>v0.0.3 Client update</ng-template>
                <ng-template ngbPanelContent>
                  <ul>
                    <li>Added queue state indicators</li>
                    <li>Enabled passive abilities of pets</li>
                    <li>Fixed a bunch of matchmaking and hero bugs</li>
                    <li>Added Patreon Supporter icons in chat</li>
                  </ul>
                </ng-template>
              </ngb-panel>

              <ngb-panel>
                <ng-template ngbPanelTitle>v0.0.2 Client update</ng-template>
                <ng-template ngbPanelContent>
                  <ul>
                    <li>Added all the previously missed heroes</li>
                    <li>Added all pets</li>
                    <li>Added selection for gamemodes</li>
                    <li>Removed Blazer (<a target="_blank" href="https://www.strawpoll.me/17936571/r">community
                        decission</a>)
                    </li>
                    <li>Added a icon for <a href="https://www.patreon.com/strife_ce" target="_blank">Patreon
                        Supporters</a> in
                      chat
                    </li>
                    <li>Fixed chat scroll issues</li>
                    <li>Client redesign</li>
                  </ul>
                </ng-template>
              </ngb-panel>
            </ngb-accordion>
          </div>
        </div>
      </div>
      <div class="col-md-6" style="padding-left:0px; border-left: 1px solid #ddd">
        <h5 class="title">Community Support</h5>
        <div style="padding:10px; max-height: 170px; overflow: hidden; font-size: 12px">
          <div>
            <span>Many thanks to our most recent supporters:</span>
          </div>

          <div class="row" style="padding-top: 2px">
            <div class="col-md-6" *ngFor="let patron of latestPatrons">
              <span style="width: 16px; height:16px; margin-right:4px; display: inline-block">
                <a href="https://www.patreon.com/strife_ce" [ngbTooltip]=" patron.iconTooltip" placement="left"
                  target="_blank">
                  <img src="assets/images/icons/{{patron.icon}}.png" style="width:16px; margin-top:-5px;" />
                </a>
              </span> {{patron.name}}</div>
          </div>

          <div style="position:absolute; bottom: 0px;">
            Server cost covered By Patreon supporters:
            <a target="_blank" href="https://www.patreon.com/bePatron?u=19872450"
              data-patreon-widget-type="become-patron-button">
              <ngb-progressbar type="primary" [value]="Math.ceil(patreonData.pledge_sum/70) " [striped]="true"
                [animated]="false" height="24px">
                <div style="position:absolute; font-weight:500; width:100%; font-size: 14px; ">
                  {{Math.ceil(patreonData.pledge_sum / 100)}}$ of 70$</div>
              </ngb-progressbar>
            </a>
            <a target="_blank" href="https://www.patreon.com/bePatron?u=19872450"
              style="display:inline-block; overflow: hidden; width: 190px;">
              <img src="assets/images/patreon_button.png" style="height:40px; margin-left: -8px;" />
            </a>
            <a target="_blank" href="https://www.paypal.me/strifece"
              style="display:inline-block; overflow:hidden; width:106px;">
              <img src="assets/images/paypal.png" style="height:44px; margin-left: 10px;" />
            </a>
          </div>
        </div>
      </div>

    </div>

  </div>
</div>

<ng-template #invitePlayers let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Invite other players to your party</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.close()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form>
      <div class="form-group">
        You can invite up to <b>{{getMaxInviteCount() - partyPlayerInvites.size}} more</b> players:
        <br /><br />
        <div>
          <div *ngIf="getChatAccounts(false).length != 0; else noAvailablePlayers">
            <div *ngFor="let acc of getChatAccounts(false)">
              <div class="checkbox" *ngIf="acc.canReceivePartyInvite">
                <label style="width:100%">
                  <input type="checkbox" (change)="changePartyInviteState(acc,$event)"
                    [disabled]="(getMaxInviteCount() - partyPlayerInvites.size) <= 0 && !partyPlayerInvites.has(acc)">
                  {{acc.name}}
                </label>
              </div>
            </div>
          </div>
          <ng-template #noAvailablePlayers>
            Currently are no other players available for an invitation.
          </ng-template>
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger float-left" (click)="modal.close()"
      style="position:absolute; left:15px">Abort</button>
    <button type="button" class="btn btn-success" (click)="inviteToParty(); modal.close()">Invite</button>
  </div>
</ng-template>

<ng-template #partyInvite let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">You are invited into a party</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.close()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form>
      <div class="form-group">
        <div>
          You received a party-invitation by: <b>{{inviteParty.chief.name}}</b>
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger float-left" (click)="declinePartyInvite(inviteParty); modal.close()"
      style="position:absolute; left:15px">Decline</button>
    <button type="button" class="btn btn-success float-right"
      (click)="acceptPartyInvite(inviteParty); modal.close()">Accept</button>
  </div>
</ng-template>
